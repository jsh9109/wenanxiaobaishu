<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ’æŒ‡æ–‡æ¡ˆç”Ÿæˆå™¨ - å°çº¢ä¹¦</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #e91e63 0%, #f06292 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #e91e63 0%, #f06292 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 14px;
        }
        
        .admin-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.5);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }
        
        .admin-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .content {
            padding: 30px;
        }
        
        .section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            display: flex;
            align-items: center;
        }
        
        .section-title::before {
            content: "";
            display: inline-block;
            width: 4px;
            height: 20px;
            background: #667eea;
            margin-right: 10px;
            border-radius: 2px;
        }
        
        .info-box {
            background: white;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 4px;
        }
        
        .info-box h3 {
            color: #667eea;
            font-size: 16px;
            margin-bottom: 10px;
        }
        
        .info-box p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 8px;
        }
        
        .info-box a {
            color: #667eea;
            text-decoration: none;
            font-weight: bold;
        }
        
        .info-box a:hover {
            text-decoration: underline;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
            font-size: 14px;
        }
        
        input[type="text"],
        input[type="password"],
        input[type="date"],
        input[type="file"],
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        input:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-download {
            background: #17a2b8;
            color: white;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .status {
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .hidden {
            display: none !important;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: bold;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }
        
        .code-display {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin: 20px 0;
        }
        
        .code-text {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
        }
        
        .code-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .code-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid #e0e0e0;
        }
        
        .progress-container {
            margin-top: 20px;
        }
        
        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        .log {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.8;
        }
        
        .log-item {
            margin-bottom: 5px;
            padding: 5px;
            border-left: 3px solid #667eea;
            padding-left: 10px;
        }
        
        .quick-date {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .quick-date button {
            flex: 1;
            padding: 8px;
            background: #e9ecef;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .quick-date button:hover {
            background: #dee2e6;
        }
        
        .highlight {
            background: #fff3cd;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
        }
        
        .template-info {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 15px;
        }
        
        .template-info strong {
            color: #0066cc;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <button class="admin-btn" onclick="showAdminModal()">ğŸ”§ ç®¡ç†å‘˜</button>
            <h1>ğŸ’ æˆ’æŒ‡æ–‡æ¡ˆç”Ÿæˆå™¨</h1>
            <p>ç½‘é¡µç‰ˆ v2.0 - ä¸“ä¸šã€é«˜æ•ˆã€æ˜“ç”¨</p>
        </div>
        
        <div class="content">
            <!-- é‡è¦æç¤ºï¼šAPIæ³¨å†Œ -->
            <div class="section">
                <div class="section-title">ğŸ“¢ ä½¿ç”¨å‰å¿…è¯»</div>
                
                <div class="info-box">
                    <h3>ğŸ”‘ ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œå¹¶è´­ä¹°API</h3>
                    <p>æœ¬å·¥å…·éœ€è¦é…åˆGPTs APIä½¿ç”¨ï¼Œè¯·å…ˆæ³¨å†Œå¹¶å……å€¼ï¼š</p>
                    <p>
                        <strong>å®˜æ–¹ç½‘ç«™ï¼š</strong>
                        <a href="https://gptsapi.net/api" target="_blank">https://gptsapi.net/api</a>
                    </p>
                    <p>
                        <strong>æ³¨å†Œæµç¨‹ï¼š</strong>
                        1. ç‚¹å‡»ä¸Šæ–¹é“¾æ¥æ³¨å†Œè´¦å· â†’ 
                        2. å……å€¼ï¼ˆå»ºè®®Â¥5èµ·ï¼Œå¯ç”Ÿæˆçº¦50æ¡ï¼‰ â†’ 
                        3. è·å–API Key
                    </p>
                    <p>
                        <strong>è´¹ç”¨è¯´æ˜ï¼š</strong>
                        çº¦ Â¥0.1/æ¡æ–‡æ¡ˆï¼Œ50æ¡çº¦Â¥5ï¼Œä¸éœ€è¦æ¢¯å­ï¼Œå›½å†…å¯ç”¨
                    </p>
                    <p style="margin-top: 10px;">
                        <button class="btn btn-primary" onclick="showUserGuide()" style="padding: 8px 20px; font-size: 13px;">
                            ğŸ“– æŸ¥çœ‹è¯¦ç»†ä½¿ç”¨è¯´æ˜
                        </button>
                    </p>
                </div>
                
                <div class="info-box">
                    <h3>ğŸ“¥ ç¬¬äºŒæ­¥ï¼šä¸¤æ­¥æµç¨‹ç”Ÿæˆæ–‡æ¡ˆ</h3>
                    
                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #ffc107;">
                        <strong style="color: #856404; font-size: 16px;">ğŸ’¡ å®Œæ•´æµç¨‹è¯´æ˜</strong><br>
                        <div style="margin-top: 10px; line-height: 2; color: #856404;">
                            <strong>â†’ æ­¥éª¤1ï¼šæ™ºèƒ½åˆ†é…é€‰é¢˜</strong><br>
                            ã€€ã€€ä¸‹è½½ç©ºç™½æ¨¡æ¿ â†’ å¡«å†™æ ‡é¢˜ â†’ ä¸Šä¼ è·å–æ™ºèƒ½åˆ†é…ç»“æœ<br><br>
                            <strong>â†’ æ­¥éª¤2ï¼šæ‰¹é‡ç”Ÿæˆæ–‡æ¡ˆ</strong><br>
                            ã€€ã€€ä¸Šä¼ åˆ†é…ç»“æœ â†’ å¼€å§‹ç”Ÿæˆ â†’ ä¸‹è½½æœ€ç»ˆæ–‡æ¡ˆ
                        </div>
                    </div>
                </div>
                
                <!-- æ­¥éª¤1ï¼šæ™ºèƒ½åˆ†é…é€‰é¢˜ -->
                <div class="info-box" style="border-left: 4px solid #28a745;">
                    <h3>ğŸ¯ æ­¥éª¤1ï¼šæ™ºèƒ½åˆ†é…é€‰é¢˜</h3>
                    
                    <div style="background: #e7f3ff; padding: 12px; border-radius: 6px; margin-bottom: 15px;">
                        <strong style="color: #0066cc;">æ“ä½œæµç¨‹ï¼š</strong><br>
                        1ï¸âƒ£ ä¸‹è½½ç©ºç™½æ¨¡æ¿ â†’ 2ï¸âƒ£ å¡«å†™æ ‡é¢˜åˆ— â†’ 3ï¸âƒ£ ä¸Šä¼ æ™ºèƒ½åˆ†é… â†’ 4ï¸âƒ£ ä¸‹è½½åˆ†é…ç»“æœ
                    </div>
                    
                    <div class="btn-group">
                        <button class="btn btn-download" onclick="downloadBlankTemplate()">
                            ğŸ“¥ 1. ä¸‹è½½ç©ºç™½æ¨¡æ¿
                        </button>
                        <button class="btn btn-success" onclick="showTopicAssigner()">
                            ğŸ¯ 2. æ™ºèƒ½åˆ†é…é€‰é¢˜
                        </button>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; margin-top: 15px; font-size: 13px;">
                        <strong>ğŸ“‹ ç©ºç™½æ¨¡æ¿æ ¼å¼ï¼š</strong>åªæœ‰"æ ‡é¢˜"åˆ—<br>
                        <strong>ğŸ“‹ åˆ†é…ç»“æœæ ¼å¼ï¼š</strong>åºå·ã€æ¨¡æ¿ç±»å‹ã€æ ‡é¢˜ã€é€‰é¢˜ã€ç”Ÿæˆæ•°é‡
                    </div>
                </div>
                
                <!-- æ­¥éª¤2ï¼šæ‰¹é‡ç”Ÿæˆï¼ˆåœ¨ç”ŸæˆåŒºåŸŸä¼šè¯¦ç»†è¯´æ˜ï¼‰ -->
            </div>
            </div>
            
            <!-- é€‰é¢˜æ™ºèƒ½åˆ†é…å·¥å…· -->
            <div class="section hidden" id="topicAssignerSection">
                <div class="section-title">ğŸ¯ æ­¥éª¤1-2ï¼šæ™ºèƒ½åˆ†é…é€‰é¢˜</div>
                
                <div class="info-box" style="background: #e7f3ff; border-left: 4px solid #0066cc;">
                    <h3 style="color: #0066cc; margin-bottom: 10px;">ğŸ“¤ ä¸Šä¼ å¡«å†™å¥½çš„æ ‡é¢˜Excel</h3>
                    <p style="margin-bottom: 10px;">
                        <strong>ç³»ç»Ÿå°†è‡ªåŠ¨ä¸ºæ¯ä¸ªæ ‡é¢˜åˆ†é…ï¼š</strong>
                    </p>
                    <div style="background: white; padding: 10px; border-radius: 6px;">
                        âœ… <strong>æ¨¡æ¿ç±»å‹</strong>ï¼šæ¨¡æ¿1ï¼ˆæŠ€èƒ½ç±»ï¼‰/ æ¨¡æ¿2ï¼ˆåŸå› ç±»ï¼‰/ æ¨¡æ¿3ï¼ˆæ•™ç¨‹ç±»ï¼‰<br>
                        âœ… <strong>é€‰é¢˜/ä¸»é¢˜</strong>ï¼šæ¥è¯ã€äººæƒ…ä¸–æ•…ã€ç¤¾äº¤æ™ºæ…§ã€ç©ä¸ç†Ÿã€é˜²å¥—è¯ã€é€šç”¨<br>
                        âœ… <strong>ç”Ÿæˆæ•°é‡</strong>ï¼šé»˜è®¤æ¯ä¸ªæ ‡é¢˜ç”Ÿæˆ1æ¡ï¼ˆå¯ä¿®æ”¹ï¼‰
                    </div>
                </div>
                
                <div class="form-group">
                    <label>ä¸Šä¼ æ ‡é¢˜Excelï¼ˆä»…åŒ…å«"æ ‡é¢˜"åˆ—ï¼‰</label>
                    <input type="file" id="titleFile" accept=".xlsx,.xls" onchange="handleTitleFile()">
                    <div class="status hidden" id="titleFileInfo"></div>
                </div>
                
                <button class="btn btn-primary" id="assignBtn" onclick="assignTopics()" disabled>å¼€å§‹æ™ºèƒ½åˆ†é…</button>
                
                <div class="progress-container hidden" id="assignProgress">
                    <div class="status info" id="assignStatus"></div>
                </div>
            </div>

            <!-- ç”¨æˆ·ç«¯ï¼šæ¿€æ´»åŒº -->
            <div class="section" id="activationSection">
                <div class="section-title">ğŸ”‘ è½¯ä»¶æ¿€æ´»</div>
                <div class="form-group">
                    <label>æ¿€æ´»ç </label>
                    <input type="text" id="activationCode" placeholder="ä¾‹å¦‚: XHS-ALL-20261231-7BF5">
                </div>
                <button class="btn btn-primary" onclick="activate()">æ¿€æ´»è½¯ä»¶</button>
                <div class="status hidden" id="activationStatus"></div>
            </div>
            
            <!-- ç”¨æˆ·ç«¯ï¼šå·²æ¿€æ´»ä¿¡æ¯ -->
            <div class="section hidden" id="activatedInfo">
                <div class="section-title">âœ… å·²æ¿€æ´»</div>
                <p>ä¸šåŠ¡çº¿: <span id="businessInfo"></span></p>
                <p>åˆ°æœŸæ—¶é—´: <span id="expireInfo"></span></p>
                <button class="btn btn-secondary" onclick="resetActivation()">é‡æ–°æ¿€æ´»</button>
            </div>
            
            <!-- ç”¨æˆ·ç«¯ï¼šAPIé…ç½® -->
            <div class="section hidden" id="apiSection">
                <div class="section-title">âš™ï¸ APIé…ç½®</div>
                <div class="info-box">
                    <p>è¯·è¾“å…¥æ‚¨ä» <a href="https://gptsapi.net/api" target="_blank">GPTs API</a> è·å–çš„API Key</p>
                </div>
                <div class="form-group">
                    <label>GPTs API Key</label>
                    <input type="password" id="apiKey" placeholder="sk-xxxxxxxxxxxxxxxx">
                </div>
                <button class="btn btn-primary" onclick="saveApiKey()">ä¿å­˜é…ç½®</button>
                <div class="status hidden" id="apiStatus"></div>
            </div>
            
            <!-- ç”¨æˆ·ç«¯ï¼šç”ŸæˆåŒº -->
            <div class="section hidden" id="generateSection">
                <div class="section-title">ğŸ“ æ‰¹é‡ç”Ÿæˆ</div>
                
                <div class="info-box">
                    <p>
                        <strong>æ¸©é¦¨æç¤ºï¼š</strong>
                        è¯·ä½¿ç”¨ 
                        <button class="btn btn-download" onclick="downloadTemplate()" style="padding: 4px 12px; font-size: 12px; display: inline-block; margin: 0;">
                            ğŸ“¥ ä¸‹è½½æ ‡é¢˜æ¨¡æ¿
                        </button>
                        å¡«å†™åä¸Šä¼ ï¼Œé¿å…æ ¼å¼é”™è¯¯
                    </p>
                </div>
                
                <div class="form-group">
                    <label>ä¸Šä¼ æ ‡é¢˜Excelæ–‡ä»¶</label>
                    <input type="file" id="excelFile" accept=".xlsx,.xls" onchange="handleFileSelect()">
                    <div class="status hidden" id="fileInfo"></div>
                </div>
                
                <button class="btn btn-primary" id="generateBtn" onclick="startGeneration()" disabled>å¼€å§‹ç”Ÿæˆ</button>
                <button class="btn" style="background: #ff9800; color: white; display: none;" onclick="pauseGeneration()" id="pauseBtn">â¸ï¸ æš‚åœ</button>
                <button class="btn" style="background: #4CAF50; color: white; display: none;" onclick="resumeGeneration()" id="resumeBtn">â–¶ï¸ ç»§ç»­</button>
                
                <div class="progress-container hidden" id="progressContainer">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill">0%</div>
                    </div>
                    <div class="log" id="log"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- ç®¡ç†å‘˜æ¨¡æ€æ¡† -->
    <div class="modal" id="adminModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">ğŸ”§ ç®¡ç†å‘˜é¢æ¿</div>
                <button class="close-btn" onclick="closeAdminModal()">Ã—</button>
            </div>
            
            <!-- ç®¡ç†å‘˜ç™»å½• -->
            <div id="adminLogin">
                <div class="form-group">
                    <label>ç®¡ç†å‘˜å¯†ç </label>
                    <input type="password" id="adminPassword" placeholder="è¾“å…¥ç®¡ç†å‘˜å¯†ç ">
                </div>
                <button class="btn btn-primary" onclick="adminLogin()">ç™»å½•</button>
                <div class="status hidden" id="adminLoginStatus"></div>
            </div>
            
            <!-- ç®¡ç†å‘˜åŠŸèƒ½ -->
            <div id="adminPanel" class="hidden">
                <div class="section">
                    <div class="section-title">ğŸ« ç”Ÿæˆæ¿€æ´»ç </div>
                    
                    <div class="form-group">
                        <label>ä¸šåŠ¡çº¿</label>
                        <select id="businessType">
                            <option value="social">ç¤¾ä¼šåŒ–æŒ‡å—</option>
                            <option value="ring">æˆ’æŒ‡</option>
                            <option value="travel">æ—…æ¸¸</option>
                            <option value="psychology">å¿ƒç†æµ‹è¯•</option>
                            <option value="all">å…¨éƒ¨ä¸šåŠ¡çº¿</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>åˆ°æœŸæ—¥æœŸ</label>
                        <input type="date" id="expireDate">
                        <div class="quick-date">
                            <button onclick="setQuickDate(30)">1ä¸ªæœˆ</button>
                            <button onclick="setQuickDate(90)">3ä¸ªæœˆ</button>
                            <button onclick="setQuickDate(180)">6ä¸ªæœˆ</button>
                            <button onclick="setQuickDate(365)">1å¹´</button>
                            <button onclick="setQuickDate(3650)">æ°¸ä¹…</button>
                        </div>
                    </div>
                    
                    <button class="btn btn-success" onclick="generateCode()">ç”Ÿæˆæ¿€æ´»ç </button>
                    
                    <div class="code-display hidden" id="codeDisplay">
                        <div class="code-text" id="generatedCode"></div>
                        <button class="btn btn-primary" onclick="copyCode()">å¤åˆ¶æ¿€æ´»ç </button>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">ğŸ“‹ å·²ç”Ÿæˆæ¿€æ´»ç åˆ—è¡¨</div>
                    <div class="code-list" id="codeList"></div>
                </div>
                
                <button class="btn btn-secondary" onclick="adminLogout()">é€€å‡ºç®¡ç†</button>
            </div>
        </div>
    </div>

    <!-- ä½¿ç”¨è¯´æ˜æ¨¡æ€æ¡† -->
    <div class="modal" id="guideModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">ğŸ“– è¯¦ç»†ä½¿ç”¨è¯´æ˜</div>
                <button class="close-btn" onclick="closeGuideModal()">Ã—</button>
            </div>
            
            <div style="max-height: 70vh; overflow-y: auto; padding: 10px;">
                
                <div class="info-box">
                    <h3 style="color: #667eea; font-size: 18px; margin-bottom: 15px;">
                        ğŸ¯ å®Œæ•´ä½¿ç”¨æµç¨‹ï¼ˆå°ç™½ç‰ˆï¼‰
                    </h3>
                    <p style="font-size: 14px; color: #666; line-height: 1.8;">
                        æœ¬å·¥å…·å¯ä»¥æ‰¹é‡ç”Ÿæˆå°çº¢ä¹¦æ–‡æ¡ˆï¼Œåªéœ€3æ­¥å³å¯å®Œæˆã€‚ä»¥ä¸‹æ˜¯ä»é›¶å¼€å§‹çš„å®Œæ•´æ•™ç¨‹ã€‚
                    </p>
                </div>

                <!-- ç¬¬ä¸€æ­¥ -->
                <div class="section" style="margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px; font-size: 16px;">
                        ğŸ“ ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œå¹¶è´­ä¹°APIï¼ˆå¿…é¡»å®Œæˆï¼‰
                    </h3>
                    
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            1.1 æ‰“å¼€æ³¨å†Œç½‘ç«™
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»è¿™ä¸ªé“¾æ¥ï¼š<a href="https://gptsapi.net/api" target="_blank" style="color: #667eea; font-weight: bold;">https://gptsapi.net/api</a>
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æˆ–è€…å¤åˆ¶ç½‘å€åˆ°æµè§ˆå™¨æ‰“å¼€
                        </p>
                        <p style="color: #999; font-size: 12px; font-style: italic;">
                            ğŸ’¡ æç¤ºï¼šè¿™æ˜¯å®˜æ–¹APIæœåŠ¡å•†ï¼Œå®‰å…¨å¯é 
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            1.2 æ³¨å†Œè´¦å·
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»ç½‘ç«™ä¸Šçš„"æ³¨å†Œ"æŒ‰é’®
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ è¾“å…¥é‚®ç®±å’Œå¯†ç ï¼ˆè®°ä½å¯†ç ï¼ï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»"æ³¨å†Œ"å®Œæˆ
                        </p>
                        <p style="color: #999; font-size: 12px; font-style: italic;">
                            â±ï¸ è€—æ—¶ï¼š1åˆ†é’Ÿ
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            1.3 å……å€¼ï¼ˆé‡è¦ï¼ï¼‰
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç™»å½•åï¼Œæ‰¾åˆ°"å……å€¼"æˆ–"ä½™é¢"æŒ‰é’®
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ <strong style="color: #e74c3c;">å»ºè®®å……å€¼ï¼šÂ¥5å…ƒ</strong>ï¼ˆå¯ç”Ÿæˆçº¦50æ¡æ–‡æ¡ˆï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ”¯ä»˜æ–¹å¼ï¼šå¾®ä¿¡/æ”¯ä»˜å®/é“¶è¡Œå¡
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å……å€¼åä½™é¢ç«‹å³åˆ°è´¦
                        </p>
                        <div style="background: #fff3cd; padding: 10px; border-radius: 6px; margin-top: 10px;">
                            <p style="color: #856404; font-size: 12px; margin: 0;">
                                ğŸ’° <strong>è´¹ç”¨è¯´æ˜ï¼š</strong><br>
                                â€¢ 1æ¡æ–‡æ¡ˆ â‰ˆ Â¥0.1<br>
                                â€¢ 50æ¡æ–‡æ¡ˆ â‰ˆ Â¥5<br>
                                â€¢ 100æ¡æ–‡æ¡ˆ â‰ˆ Â¥10<br>
                                <strong>ç”¨å¤šå°‘æ‰£å¤šå°‘ï¼Œä½™é¢å¯æŸ¥çœ‹</strong>
                            </p>
                        </div>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            1.4 è·å–API Keyï¼ˆå…³é”®ï¼ï¼‰
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å……å€¼åï¼Œæ‰¾åˆ°"APIç®¡ç†"æˆ–"API Key"èœå•
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»"åˆ›å»ºæ–°çš„API Key"
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ <strong style="color: #e74c3c;">å¤åˆ¶è¿™ä¸ªKeyå¹¶ä¿å­˜å¥½ï¼</strong>
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ Keyæ ¼å¼ç±»ä¼¼ï¼šsk-xxxxxxxxxxxxxxxx
                        </p>
                        <div style="background: #f8d7da; padding: 10px; border-radius: 6px; margin-top: 10px;">
                            <p style="color: #721c24; font-size: 12px; margin: 0;">
                                âš ï¸ <strong>é‡è¦æé†’ï¼š</strong><br>
                                â€¢ API Keyåªæ˜¾ç¤ºä¸€æ¬¡ï¼Œä¸€å®šè¦å¤åˆ¶ä¿å­˜ï¼<br>
                                â€¢ ä¸¢å¤±äº†éœ€è¦é‡æ–°åˆ›å»º
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ç¬¬äºŒæ­¥ -->
                <div class="section" style="margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px; font-size: 16px;">
                        ğŸ“‹ ç¬¬äºŒæ­¥ï¼šå‡†å¤‡æ ‡é¢˜Excelæ–‡ä»¶
                    </h3>
                    
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            2.1 ä¸‹è½½æ¨¡æ¿ï¼ˆå¼ºçƒˆå»ºè®®ï¼ï¼‰
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ åœ¨å·¥å…·ä¸»é¡µæ‰¾åˆ°"ğŸ“¥ ä¸‹è½½æ ‡é¢˜æ¨¡æ¿"æŒ‰é’®
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»åè‡ªåŠ¨ä¸‹è½½Excelæ–‡ä»¶
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ–‡ä»¶åï¼š<span style="color: #667eea;">å°çº¢ä¹¦æ ‡é¢˜æ¨¡æ¿.xlsx</span>
                        </p>
                        <p style="color: #999; font-size: 12px; font-style: italic;">
                            ğŸ’¡ ä¸ºä»€ä¹ˆè¦ç”¨æ¨¡æ¿ï¼Ÿé¿å…æ ¼å¼é”™è¯¯ï¼Œçœæ—¶çœåŠ›ï¼
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            2.2 å¡«å†™æ ‡é¢˜ï¼ˆæŒ‰æ¨¡æ¿æ ¼å¼ï¼‰
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ‰“å¼€ä¸‹è½½çš„æ¨¡æ¿æ–‡ä»¶ï¼ˆç”¨Excelæˆ–WPSï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ çœ‹åˆ°ä¸¤åˆ—ï¼š<strong>"æ ‡é¢˜"</strong> å’Œ <strong>"é€‰é¢˜"</strong>
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ åˆ é™¤æ¨¡æ¿é‡Œçš„ç¤ºä¾‹æ•°æ®
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ åœ¨"<strong>æ ‡é¢˜</strong>"åˆ—å¡«å†™ä½ çš„æ ‡é¢˜ï¼ˆå¿…å¡«ï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ åœ¨"<strong>é€‰é¢˜</strong>"åˆ—å¡«å†™ç±»å‹ï¼ˆå¯é€‰ï¼Œå¦‚ï¼šæ¥è¯ã€äººæƒ…ä¸–æ•…ï¼‰
                        </p>
                        <div style="background: #d1ecf1; padding: 10px; border-radius: 6px; margin-top: 10px;">
                            <p style="color: #0c5460; font-size: 12px; margin: 0;">
                                ğŸ“ <strong>å¡«å†™ç¤ºä¾‹ï¼š</strong>
                            </p>
                            <table style="width: 100%; margin-top: 8px; border-collapse: collapse;">
                                <tr style="background: #bee5eb;">
                                    <td style="padding: 6px; border: 1px solid #0c5460; font-weight: bold; font-size: 12px;">æ ‡é¢˜</td>
                                    <td style="padding: 6px; border: 1px solid #0c5460; font-weight: bold; font-size: 12px;">é€‰é¢˜</td>
                                </tr>
                                <tr>
                                    <td style="padding: 6px; border: 1px solid #0c5460; font-size: 12px;">ä¼šåŠäº‹çš„å¥³å­©å­æœ‰å¤šå‰å®³</td>
                                    <td style="padding: 6px; border: 1px solid #0c5460; font-size: 12px;">æ¥è¯</td>
                                </tr>
                                <tr>
                                    <td style="padding: 6px; border: 1px solid #0c5460; font-size: 12px;">ä½ çš„ç­”è°¢æ–¹å¼æš´éœ²äº†ç¤¾äº¤æ®µä½</td>
                                    <td style="padding: 6px; border: 1px solid #0c5460; font-size: 12px;">äººæƒ…ä¸–æ•…</td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            2.3 ä¿å­˜æ–‡ä»¶
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å¡«å†™å®Œæˆåï¼Œç‚¹å‡»"ä¿å­˜"ï¼ˆCtrl+Sï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ è®°ä½æ–‡ä»¶ä¿å­˜ä½ç½®ï¼ˆå¦‚ï¼šæ¡Œé¢ï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å…³é—­Excelæ–‡ä»¶
                        </p>
                    </div>
                </div>

                <!-- ç¬¬ä¸‰æ­¥ -->
                <div class="section" style="margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px; font-size: 16px;">
                        ğŸš€ ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨ç”Ÿæˆå™¨ç”Ÿæˆæ–‡æ¡ˆ
                    </h3>
                    
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            3.1 æ¿€æ´»è½¯ä»¶
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ‰¾åˆ°"ğŸ”‘ è½¯ä»¶æ¿€æ´»"åŒºåŸŸ
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ è¾“å…¥ç®¡ç†å‘˜ç»™ä½ çš„æ¿€æ´»ç 
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ¿€æ´»ç æ ¼å¼ï¼šXHS-XXX-XXXXXXXX-XXXX
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»"æ¿€æ´»è½¯ä»¶"
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ çœ‹åˆ°"âœ… æ¿€æ´»æˆåŠŸ"æç¤º
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            3.2 é…ç½®API Key
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ¿€æ´»åä¼šçœ‹åˆ°"âš™ï¸ APIé…ç½®"åŒºåŸŸ
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ åœ¨è¾“å…¥æ¡†ä¸­ç²˜è´´ä½ çš„API Keyï¼ˆç¬¬ä¸€æ­¥è·å–çš„ï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»"ä¿å­˜é…ç½®"
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ çœ‹åˆ°"âœ… API Keyå·²ä¿å­˜"
                        </p>
                        <div style="background: #f8d7da; padding: 10px; border-radius: 6px; margin-top: 10px;">
                            <p style="color: #721c24; font-size: 12px; margin: 0;">
                                âš ï¸ <strong>æ‰¾ä¸åˆ°API Keyï¼Ÿ</strong><br>
                                å›åˆ°ç¬¬ä¸€æ­¥1.4ï¼Œé‡æ–°æŸ¥çœ‹è·å–æ–¹æ³•
                            </p>
                        </div>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            3.3 ä¸Šä¼ Excelæ–‡ä»¶
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ é…ç½®å®Œæˆåä¼šçœ‹åˆ°"ğŸ“ æ‰¹é‡ç”Ÿæˆ"åŒºåŸŸ
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»"é€‰æ‹©Excelæ–‡ä»¶"æˆ–"é€‰æ‹©æ–‡ä»¶"
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ‰¾åˆ°ä½ åˆšæ‰ä¿å­˜çš„Excelæ–‡ä»¶
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ åŒå‡»æ–‡ä»¶æˆ–ç‚¹å‡»"æ‰“å¼€"
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ çœ‹åˆ°"âœ… æ–‡ä»¶: xxx.xlsx | æ•°æ®: X æ¡"
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            3.4 å¼€å§‹ç”Ÿæˆ
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»è“è‰²çš„"å¼€å§‹ç”Ÿæˆ"æŒ‰é’®
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ä¼šå‡ºç°è¿›åº¦æ¡å’Œæ—¥å¿—
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ çœ‹åˆ°è¿›åº¦ï¼š1/10ã€2/10... é€æ­¥ç”Ÿæˆ
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ <strong>è€å¿ƒç­‰å¾…</strong>ï¼ˆæ¯æ¡çº¦3-5ç§’ï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å…¨éƒ¨å®Œæˆåè‡ªåŠ¨ä¸‹è½½ç»“æœæ–‡ä»¶
                        </p>
                        <div style="background: #d4edda; padding: 10px; border-radius: 6px; margin-top: 10px;">
                            <p style="color: #155724; font-size: 12px; margin: 0;">
                                â±ï¸ <strong>ç”Ÿæˆæ—¶é—´ä¼°ç®—ï¼š</strong><br>
                                â€¢ 10æ¡æ ‡é¢˜ â‰ˆ 30-50ç§’<br>
                                â€¢ 50æ¡æ ‡é¢˜ â‰ˆ 3-5åˆ†é’Ÿ<br>
                                â€¢ 100æ¡æ ‡é¢˜ â‰ˆ 5-10åˆ†é’Ÿ
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ç¬¬å››æ­¥ -->
                <div class="section" style="margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px; font-size: 16px;">
                        ğŸ“¥ ç¬¬å››æ­¥ï¼šæŸ¥çœ‹å’Œä½¿ç”¨ç”Ÿæˆç»“æœ
                    </h3>
                    
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            4.1 æ‰“å¼€ç»“æœæ–‡ä»¶
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç”Ÿæˆå®Œæˆåä¼šè‡ªåŠ¨ä¸‹è½½Excelæ–‡ä»¶
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ–‡ä»¶åï¼šå°çº¢ä¹¦æ–‡æ¡ˆ_æ—¥æœŸæ—¶é—´.xlsx
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ é€šå¸¸åœ¨"ä¸‹è½½"æ–‡ä»¶å¤¹ä¸­
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ åŒå‡»æ‰“å¼€æ–‡ä»¶
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            4.2 ç»“æœæ–‡ä»¶åŒ…å«ä»€ä¹ˆ
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            Excelæ–‡ä»¶åŒ…å«ä»¥ä¸‹åˆ—ï¼š
                        </p>
                        <table style="width: 100%; margin-top: 8px; border-collapse: collapse; font-size: 12px;">
                            <tr style="background: #f8f9fa;">
                                <td style="padding: 6px; border: 1px solid #ddd; font-weight: bold;">åºå·</td>
                                <td style="padding: 6px; border: 1px solid #ddd;">1, 2, 3...</td>
                            </tr>
                            <tr>
                                <td style="padding: 6px; border: 1px solid #ddd; font-weight: bold;">æ ‡é¢˜</td>
                                <td style="padding: 6px; border: 1px solid #ddd;">ä½ æäº¤çš„æ ‡é¢˜</td>
                            </tr>
                            <tr>
                                <td style="padding: 6px; border: 1px solid #ddd; font-weight: bold;">é€‰é¢˜</td>
                                <td style="padding: 6px; border: 1px solid #ddd;">æ¥è¯/äººæƒ…ä¸–æ•…ç­‰</td>
                            </tr>
                            <tr>
                                <td style="padding: 6px; border: 1px solid #ddd; font-weight: bold;">æ–‡æ¡ˆ</td>
                                <td style="padding: 6px; border: 1px solid #ddd;"><strong>ç”Ÿæˆçš„å®Œæ•´æ–‡æ¡ˆï¼ˆ600å­—å·¦å³ï¼‰</strong></td>
                            </tr>
                            <tr>
                                <td style="padding: 6px; border: 1px solid #ddd; font-weight: bold;">å­—æ•°</td>
                                <td style="padding: 6px; border: 1px solid #ddd;">æ–‡æ¡ˆå­—æ•°ç»Ÿè®¡</td>
                            </tr>
                        </table>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            4.3 å¦‚ä½•ä½¿ç”¨æ–‡æ¡ˆ
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ‰“å¼€Excelï¼Œæ‰¾åˆ°"æ–‡æ¡ˆ"åˆ—
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å¤åˆ¶éœ€è¦çš„æ–‡æ¡ˆå†…å®¹
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç²˜è´´åˆ°å°çº¢ä¹¦å‘å¸ƒç•Œé¢
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å¯ä»¥æ ¹æ®éœ€è¦ç¨ä½œä¿®æ”¹
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å‘å¸ƒå³å¯ï¼
                        </p>
                    </div>
                </div>

                <!-- å¸¸è§é—®é¢˜ -->
                <div class="section">
                    <h3 style="color: #e74c3c; margin-bottom: 15px; font-size: 16px;">
                        â“ å¸¸è§é—®é¢˜è§£ç­”
                    </h3>
                    
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            Q1: éœ€è¦æ¢¯å­ï¼ˆVPNï¼‰å—ï¼Ÿ
                        </h4>
                        <p style="color: #666; font-size: 13px; margin: 0;">
                            <strong style="color: #28a745;">âœ… ä¸éœ€è¦ï¼</strong>å›½å†…ç½‘ç»œå¯ç›´æ¥ä½¿ç”¨ï¼ŒGPTs APIæœåŠ¡å™¨åœ¨å›½å†…å¯è®¿é—®ã€‚
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            Q2: æ¿€æ´»ç åœ¨å“ªé‡Œè·å–ï¼Ÿ
                        </h4>
                        <p style="color: #666; font-size: 13px; margin: 0;">
                            <strong>è”ç³»ç®¡ç†å‘˜è´­ä¹°ã€‚</strong>æ¿€æ´»ç åŒ…å«è½¯ä»¶ä½¿ç”¨æƒé™ï¼Œä¸åŒå¥—é¤æœ‰ä¸åŒæœ‰æ•ˆæœŸã€‚
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            Q3: APIè´¹ç”¨æ˜¯å¦å¤–ä»˜å—ï¼Ÿ
                        </h4>
                        <p style="color: #666; font-size: 13px; margin: 0;">
                            <strong style="color: #e74c3c;">æ˜¯çš„ã€‚</strong>æ¿€æ´»ç æ˜¯è½¯ä»¶è´¹ç”¨ï¼ŒAPIè´¹ç”¨éœ€è¦è‡ªå·±åœ¨GPTs APIå……å€¼ï¼ŒæŒ‰å®é™…ä½¿ç”¨é‡æ‰£è´¹ã€‚
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            Q4: ç”Ÿæˆå¤±è´¥æ€ä¹ˆåŠï¼Ÿ
                        </h4>
                        <p style="color: #666; font-size: 13px;">
                            å¯èƒ½åŸå› ï¼š<br>
                            1. API Keyé”™è¯¯ â†’ æ£€æŸ¥æ˜¯å¦å¤åˆ¶å®Œæ•´<br>
                            2. ä½™é¢ä¸è¶³ â†’ å»GPTs APIå……å€¼<br>
                            3. ç½‘ç»œé—®é¢˜ â†’ æ£€æŸ¥ç½‘ç»œè¿æ¥<br>
                            4. Excelæ ¼å¼é”™è¯¯ â†’ ä½¿ç”¨æä¾›çš„æ¨¡æ¿
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            Q5: å¯ä»¥ç”Ÿæˆå¤šå°‘æ¡ï¼Ÿ
                        </h4>
                        <p style="color: #666; font-size: 13px; margin: 0;">
                            <strong>æ²¡æœ‰é™åˆ¶ï¼</strong>å–å†³äºä½ çš„æ¿€æ´»ç æœ‰æ•ˆæœŸå’ŒAPIä½™é¢ã€‚ä½™é¢ç”¨å®Œäº†å……å€¼å³å¯ç»§ç»­ä½¿ç”¨ã€‚
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            Q6: ç”Ÿæˆçš„æ–‡æ¡ˆè´¨é‡æ€ä¹ˆæ ·ï¼Ÿ
                        </h4>
                        <p style="color: #666; font-size: 13px; margin: 0;">
                            æ–‡æ¡ˆç”±Claude AIç”Ÿæˆï¼Œè´¨é‡å¾ˆé«˜ï¼Œçº¦600å­—ï¼ŒåŒ…å«emojiå’Œè¯é¢˜æ ‡ç­¾ï¼Œç›´æ¥å¯ç”¨ã€‚å»ºè®®ç¨ä½œä¿®æ”¹æ›´ç¬¦åˆä¸ªäººé£æ ¼ã€‚
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            Q7: ä½™é¢æŸ¥è¯¢åœ¨å“ªé‡Œï¼Ÿ
                        </h4>
                        <p style="color: #666; font-size: 13px; margin: 0;">
                            ç™»å½• <a href="https://gptsapi.net/api" target="_blank" style="color: #667eea;">GPTs APIå®˜ç½‘</a>ï¼Œåœ¨ç”¨æˆ·ä¸­å¿ƒå¯ä»¥çœ‹åˆ°ä½™é¢å’Œæ¶ˆè´¹è®°å½•ã€‚
                        </p>
                    </div>
                </div>

                <!-- å¿«é€Ÿæ£€æŸ¥æ¸…å• -->
                <div class="info-box" style="background: #d4edda; border-color: #c3e6cb;">
                    <h3 style="color: #155724; font-size: 16px; margin-bottom: 15px;">
                        âœ… ä½¿ç”¨å‰å¿«é€Ÿæ£€æŸ¥æ¸…å•
                    </h3>
                    <div style="font-size: 13px; color: #155724; line-height: 2;">
                        â˜‘ï¸ å·²åœ¨ GPTs API æ³¨å†Œå¹¶å……å€¼ï¼ˆè‡³å°‘Â¥5ï¼‰<br>
                        â˜‘ï¸ å·²è·å–å¹¶ä¿å­˜ API Key<br>
                        â˜‘ï¸ å·²ä¸‹è½½æ ‡é¢˜æ¨¡æ¿å¹¶å¡«å†™å¥½æ ‡é¢˜<br>
                        â˜‘ï¸ å·²è·å¾—æ¿€æ´»ç <br>
                        â˜‘ï¸ ç½‘ç»œè¿æ¥æ­£å¸¸<br>
                        <br>
                        <strong>å…¨éƒ¨æ‰“å‹¾ï¼Ÿå¼€å§‹ç”Ÿæˆå§ï¼ğŸš€</strong>
                    </div>
                </div>

            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-primary" onclick="closeGuideModal()">æˆ‘çŸ¥é“äº†</button>
            </div>
        </div>
    </div>

    <script>
        // ========== é…ç½® ==========
        const CONFIG = {
            SECRET_KEY: "xiaohongshu_2025_secret_key_change_me",
            ADMIN_PASSWORD: "lss900201",
            API_BASE_URL: "https://api.gptsapi.net/v1/messages",
            MODEL: "claude-sonnet-4-20250514",
            SENSITIVE_WORDS: {
                'æŠ€å·§': 'æ–¹æ³•',
                'å¸®åŠ©': 'ååŠ©',
                'æ²¦ä¸º': 'å˜æˆ',
                'æŠ€æœ¯': 'æ–¹å¼'
            }
        };
        
        // ========== è®¾å¤‡æŒ‡çº¹ ==========
        function getDeviceFingerprint() {
            // æ”¶é›†æµè§ˆå™¨ä¿¡æ¯
            const components = [
                navigator.userAgent,
                navigator.language,
                screen.width + 'x' + screen.height,
                screen.colorDepth,
                new Date().getTimezoneOffset(),
                !!window.sessionStorage,
                !!window.localStorage
            ];
            
            // CanvasæŒ‡çº¹
            try {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                ctx.textBaseline = 'top';
                ctx.font = '14px Arial';
                ctx.fillStyle = '#f60';
                ctx.fillRect(0, 0, 100, 50);
                ctx.fillStyle = '#069';
                ctx.fillText('Device Fingerprint', 2, 15);
                components.push(canvas.toDataURL());
            } catch (e) {
                components.push('canvas-error');
            }
            
            // ç”ŸæˆæŒ‡çº¹
            const fingerprint = components.join('###');
            return CryptoJS.MD5(fingerprint).toString();
        }
        
        // ========== ä½¿ç”¨è¯´æ˜æ¨¡æ€æ¡† ==========
        function showUserGuide() {
            document.getElementById('guideModal').classList.add('show');
        }
        
        function closeGuideModal() {
            document.getElementById('guideModal').classList.remove('show');
        }
        
        // ========== ä¸‹è½½æ¨¡æ¿ ==========
        
        
        // ========== é€‰é¢˜å…³é”®è¯åº“ ==========
        const TOPIC_KEYWORDS = {
            'æ¥è¯': ['æ¥è¯', 'é—²èŠ', 'é—²è°ˆ', 'èŠå¤©', 'å¯¹è¯', 'äº¤è°ˆ'],
            'äººæƒ…ä¸–æ•…': ['äººæƒ…ä¸–æ•…', 'ç­”è°¢', 'æ„Ÿè°¢', 'ç¤¼å°šå¾€æ¥', 'é€ç¤¼', 'å›ç¤¼'],
            'ç¤¾äº¤æ™ºæ…§': ['ç¤¾äº¤', 'äº¤é™…', 'åº”é…¬', 'ç¤¾ä¼šåŒ–', 'äººé™…å…³ç³»', 'å…³ç³»'],
            'ç©ä¸ç†Ÿ': ['ç©ä¸ç†Ÿ', 'è¾¹ç•Œæ„Ÿ', 'è·ç¦»', 'åˆ†å¯¸', 'ç•Œé™'],
            'é˜²å¥—è¯': ['å¥—è¯', 'è¯æœ¯', 'è¢«å¥—è·¯', 'è¯•æ¢', 'æ‰“æ¢'],
            'é€šç”¨': []
        };
        
        // ========== æ¨¡æ¿ç±»å‹å…³é”®è¯ ==========
        const TEMPLATE_KEYWORDS = {
            'æ¨¡æ¿1': ['æŠ€å·§', 'æ–¹æ³•', 'ç§˜è¯€', 'è¯€çª', 'å¦™æ‹›'],
            'æ¨¡æ¿2': ['ä¸ºä»€ä¹ˆ', 'åŸå› ', 'çœŸç›¸', 'æœ¬è´¨', 'å†…å¹•'],
            'æ¨¡æ¿3': ['å¦‚ä½•', 'æ€ä¹ˆ', 'æ€æ ·', 'æ•™ä½ ', 'å­¦ä¼š']
        };
        
        // ========== æ™ºèƒ½åŒ¹é…é€‰é¢˜ ==========
        function smartMatchTopic(title) {
            for (const [topic, keywords] of Object.entries(TOPIC_KEYWORDS)) {
                if (topic === 'é€šç”¨') continue;
                for (const keyword of keywords) {
                    if (title.includes(keyword)) {
                        return topic;
                    }
                }
            }
            return 'é€šç”¨';
        }
        
        // ========== æ™ºèƒ½åŒ¹é…æ¨¡æ¿ç±»å‹ ==========
        function smartMatchTemplate(title) {
            for (const [template, keywords] of Object.entries(TEMPLATE_KEYWORDS)) {
                for (const keyword of keywords) {
                    if (title.includes(keyword)) {
                        return template;
                    }
                }
            }
            return 'æ¨¡æ¿1';  // é»˜è®¤æ¨¡æ¿1
        }
        
        // ========== å¤„ç†æ ‡é¢˜æ–‡ä»¶ ==========
        let titleData = null;
        
        function handleTitleFile() {
            const file = document.getElementById('titleFile').files[0];
            const status = document.getElementById('titleFileInfo');
            
            if (!file) {
                status.classList.add('hidden');
                document.getElementById('assignBtn').disabled = true;
                return;
            }
            
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    const sheet = workbook.Sheets[sheetName];
                    titleData = XLSX.utils.sheet_to_json(sheet);
                    
                    if (!titleData[0] || !titleData[0]['æ ‡é¢˜']) {
                        showStatus(status, 'âŒ Excelæ–‡ä»¶å¿…é¡»åŒ…å«"æ ‡é¢˜"åˆ—', 'error');
                        document.getElementById('assignBtn').disabled = true;
                        return;
                    }
                    
                    showStatus(status, `âœ… æ–‡ä»¶: ${file.name} | æ ‡é¢˜æ•°: ${titleData.length} æ¡`, 'success');
                    document.getElementById('assignBtn').disabled = false;
                } catch (error) {
                    showStatus(status, 'âŒ æ–‡ä»¶è¯»å–å¤±è´¥ï¼š' + error.message, 'error');
                    document.getElementById('assignBtn').disabled = true;
                }
            };
            reader.readAsArrayBuffer(file);
        }
        
        // ========== æ™ºèƒ½åˆ†é…é€‰é¢˜ ==========
        function assignTopics() {
            if (!titleData) return;
            
            const status = document.getElementById('assignStatus');
            const container = document.getElementById('assignProgress');
            container.classList.remove('hidden');
            
            showStatus(status, 'æ­£åœ¨æ™ºèƒ½åˆ†é…é€‰é¢˜...', 'info');
            
            // æ™ºèƒ½åˆ†é…ï¼ˆè¿‡æ»¤ç©ºæ ‡é¢˜ï¼‰
            const results = titleData
                .filter(row => {
                    const title = (row['æ ‡é¢˜'] || '').trim();
                    return title.length > 0;  // åªä¿ç•™éç©ºæ ‡é¢˜
                })
                .map((row, index) => {
                    const title = row['æ ‡é¢˜'] || '';
                    const template = smartMatchTemplate(title);
                    const topic = smartMatchTopic(title);
                    
                    return {
                        'åºå·': index + 1,
                        'æ¨¡æ¿ç±»å‹': template,
                        'æ ‡é¢˜': title,
                        'é€‰é¢˜': topic,
                        'ç”Ÿæˆæ•°é‡': 1
                    };
                });
            
            // ä¸‹è½½ç»“æœ
            const ws = XLSX.utils.json_to_sheet(results);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "åˆ†é…ç»“æœ");
            
            ws['!cols'] = [
                { wch: 8 },   // åºå·
                { wch: 12 },  // æ¨¡æ¿ç±»å‹
                { wch: 50 },  // æ ‡é¢˜
                { wch: 15 },  // é€‰é¢˜
                { wch: 12 }   // ç”Ÿæˆæ•°é‡
            ];
            
            const timestamp = new Date().toISOString().replace(/[:-]/g, '').split('.')[0].replace('T', '_');
            XLSX.writeFile(wb, `é€‰é¢˜åˆ†é…ç»“æœ_${timestamp}.xlsx`);
            
            const nextSteps = `âœ… æ™ºèƒ½åˆ†é…å®Œæˆï¼å…±${results.length}æ¡æ ‡é¢˜

ğŸ“¥ å·²è‡ªåŠ¨ä¸‹è½½ï¼šé€‰é¢˜åˆ†é…ç»“æœ_${timestamp}.xlsx

ğŸ“‹ æ–‡ä»¶åŒ…å«åˆ—ï¼š
â€¢ åºå·
â€¢ æ¨¡æ¿ç±»å‹ï¼ˆç³»ç»Ÿæ™ºèƒ½åŒ¹é…ï¼‰
â€¢ æ ‡é¢˜ï¼ˆæ‚¨å¡«å†™çš„ï¼‰
â€¢ é€‰é¢˜ï¼ˆç³»ç»Ÿæ™ºèƒ½åŒ¹é…ï¼‰
â€¢ ç”Ÿæˆæ•°é‡ï¼ˆé»˜è®¤1ï¼Œå¯ä¿®æ”¹ï¼‰

ğŸ” ä¸‹ä¸€æ­¥æ“ä½œï¼š
1. æ‰“å¼€ä¸‹è½½çš„Excelæ–‡ä»¶
2. æ£€æŸ¥"æ¨¡æ¿ç±»å‹"å’Œ"é€‰é¢˜"æ˜¯å¦å‡†ç¡®
3. å¦‚éœ€ä¿®æ”¹ï¼Œç›´æ¥åœ¨Excelä¸­æ”¹
4. å¦‚æƒ³ç”Ÿæˆå¤šæ¡ï¼Œä¿®æ”¹"ç”Ÿæˆæ•°é‡"ä¸º2ã€3ã€5ç­‰
5. ä¿å­˜åï¼Œä¸Šä¼ åˆ°ä¸‹æ–¹"ğŸ“ æ‰¹é‡ç”Ÿæˆ"åŒºåŸŸ

ğŸ’¡ æç¤ºï¼šå¦‚æœåˆ†é…ä¸å‡†ç¡®ï¼Œå¯ä»¥æ‰‹åŠ¨ä¿®æ”¹ï¼
`;
            showStatus(status, nextSteps.replace(/\n/g, '<br>'), 'success');
        }
        
        // ========== æ•æ„Ÿè¯è¿‡æ»¤ ==========
        function filterSensitiveWords(text) {
            let filtered = text;
            
            // 1. è¿‡æ»¤æ•æ„Ÿè¯
            const words = CONFIG.SENSITIVE_WORDS || {};
            for (const word in words) {
                const replacement = words[word];
                filtered = filtered.replace(new RegExp(word, 'g'), replacement);
            }
            
            // 2. ç§»é™¤Markdownæ ¼å¼ç¬¦å·
            filtered = filtered.replace(/\*\*([^*]+)\*\*/g, '$1');  // åŠ ç²—
            filtered = filtered.replace(/__([^_]+)__/g, '$1');          // ä¸‹åˆ’çº¿
            filtered = filtered.replace(/\*([^*]+)\*/g, '$1');        // æ–œä½“
            
            // 3. ç¡®ä¿ä¹¦åæ­£ç¡®
            filtered = filtered.replace(/ã€Šé«˜æƒ…å•†[^ã€‹]+ã€‹/g, 'ã€Šæ™®é€šäººç¤¾ä¼šåŒ–æŒ‡å—ã€‹');
            filtered = filtered.replace(/ã€Šç¤¾äº¤[^ã€‹]+ã€‹/g, 'ã€Šæ™®é€šäººç¤¾ä¼šåŒ–æŒ‡å—ã€‹');
            
            return filtered;
        }
        
        // ========== æå–è¯é¢˜æ ‡ç­¾ ==========
        function extractTags(text) {
            const tagRegex = /#[^\s#]+/g;
            const tags = text.match(tagRegex);
            if (tags) {
                const cleanText = text.replace(tagRegex, '').trim();
                return { content: cleanText, tags: tags.join(' ') };
            }
            return { content: text, tags: '' };
        }
        
        
        // ========== ä¸‹è½½ç©ºç™½æ¨¡æ¿ ==========
        function downloadBlankTemplate() {
            // åˆ›å»ºç©ºç™½æ¨¡æ¿ï¼šåªæœ‰æ ‡é¢˜åˆ—
            const templateData = [
                { 'æ ‡é¢˜': 'ä¼šåŠäº‹çš„å¥³å­©å­æœ‰å¤šå‰å®³' },
                { 'æ ‡é¢˜': 'ä½ çš„ç­”è°¢æ–¹å¼æš´éœ²äº†ä½ çš„ç¤¾äº¤æ®µä½' },
                { 'æ ‡é¢˜': 'ä¸ºä»€ä¹ˆä½ åœ¨äººé™…å…³ç³»é‡Œæ€»æŒ¨æ‰“' },
                { 'æ ‡é¢˜': 'æ‹¥æœ‰é—²è°ˆåŠ›æ˜¯ç¤¾ä¼šåŒ–ç¨‹åº¦é«˜çš„ä½“ç°' },
                { 'æ ‡é¢˜': '' }  // ç©ºè¡Œä¾›ç”¨æˆ·ç»§ç»­å¡«å†™
            ];
            
            const ws = XLSX.utils.json_to_sheet(templateData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "æ ‡é¢˜åˆ—è¡¨");
            ws['!cols'] = [{ wch: 55 }];  // åŠ å®½åˆ—
            
            XLSX.writeFile(wb, 'æ­¥éª¤1_ç©ºç™½æ¨¡æ¿.xlsx');
            
            alert('âœ… å·²ä¸‹è½½ç©ºç™½æ¨¡æ¿ï¼\n\nä¸‹ä¸€æ­¥ï¼š\n1. æ‰“å¼€Excelæ–‡ä»¶\n2. åœ¨"æ ‡é¢˜"åˆ—å¡«å†™æ‚¨çš„æ ‡é¢˜\n3. ä¿å­˜åç‚¹å‡»"æ™ºèƒ½åˆ†é…é€‰é¢˜"ä¸Šä¼ ');
        }
        
        // ========== æ˜¾ç¤ºé€‰é¢˜åˆ†é…å·¥å…· ==========
        function showTopicAssigner() {
            const section = document.getElementById('topicAssignerSection');
            if (section) {
                section.classList.remove('hidden');
                section.scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        function downloadTemplate() {
            const template = [
                { 'é¡¹ç›®': 'æˆ’æŒ‡SEO', 'é¡¹ç›®ID': 'ring', 'è´¦å·': 'åº—é“º', 'äº§å“': 'æ°´æ³¢çº¹æˆ’æŒ‡', 'å…³é”®è¯': 'æˆ’æŒ‡æ¨èå°ä¼—é«˜çº§', 'åœºæ™¯': 'åŒäº‹', 'ä»·æ ¼': '13.9', 'æ•°é‡': 1 },
                { 'é¡¹ç›®': 'æˆ’æŒ‡SEO', 'é¡¹ç›®ID': 'ring', 'è´¦å·': 'åº—é“º', 'äº§å“': 'æ°´æ³¢çº¹æˆ’æŒ‡', 'å…³é”®è¯': 'æˆ’æŒ‡æ¨èå°ä¼—é«˜çº§', 'åœºæ™¯': 'èšä¼š', 'ä»·æ ¼': '13.9', 'æ•°é‡': 1 },
                { 'é¡¹ç›®': 'æˆ’æŒ‡SEO', 'é¡¹ç›®ID': 'ring', 'è´¦å·': 'åº—é“º', 'äº§å“': 'æ°´æ³¢çº¹æˆ’æŒ‡', 'å…³é”®è¯': 'æˆ’æŒ‡æ¨èå°ä¼—é«˜çº§', 'åœºæ™¯': 'æ‰‹å‹ç—›ç‚¹', 'ä»·æ ¼': '13.9', 'æ•°é‡': 1 },
                { 'é¡¹ç›®': 'æˆ’æŒ‡SEO', 'é¡¹ç›®ID': 'ring', 'è´¦å·': 'åº—é“º', 'äº§å“': 'æ°´æ³¢çº¹æˆ’æŒ‡', 'å…³é”®è¯': 'æˆ’æŒ‡æ¨èå°ä¼—é«˜çº§', 'åœºæ™¯': 'ä»·æ ¼å¯¹æ¯”', 'ä»·æ ¼': '13.9', 'æ•°é‡': 1 },
                { 'é¡¹ç›®': 'æˆ’æŒ‡SEO', 'é¡¹ç›®ID': 'ring', 'è´¦å·': 'åº—é“º', 'äº§å“': 'æ°´æ³¢çº¹æˆ’æŒ‡', 'å…³é”®è¯': 'æˆ’æŒ‡æ¨èå°ä¼—é«˜çº§', 'åœºæ™¯': 'ç”·å‹', 'ä»·æ ¼': '13.9', 'æ•°é‡': 1 },
                { 'é¡¹ç›®': 'æˆ’æŒ‡SEO', 'é¡¹ç›®ID': 'ring', 'è´¦å·': 'åº—é“º', 'äº§å“': 'æ°´æ³¢çº¹æˆ’æŒ‡', 'å…³é”®è¯': 'æˆ’æŒ‡æ¨èå°ä¼—é«˜çº§', 'åœºæ™¯': 'å¦ˆå¦ˆ', 'ä»·æ ¼': '13.9', 'æ•°é‡': 1 },
                { 'é¡¹ç›®': 'æˆ’æŒ‡SEO', 'é¡¹ç›®ID': 'ring', 'è´¦å·': 'åº—é“º', 'äº§å“': 'æ°´æ³¢çº¹æˆ’æŒ‡', 'å…³é”®è¯': 'æˆ’æŒ‡æ¨èå°ä¼—é«˜çº§', 'åœºæ™¯': 'æ‹ç…§', 'ä»·æ ¼': '13.9', 'æ•°é‡': 1 },
                { 'é¡¹ç›®': 'æˆ’æŒ‡SEO', 'é¡¹ç›®ID': 'ring', 'è´¦å·': 'åº—é“º', 'äº§å“': 'æ°´æ³¢çº¹æˆ’æŒ‡', 'å…³é”®è¯': 'æˆ’æŒ‡æ¨èå°ä¼—é«˜çº§', 'åœºæ™¯': 'é€šå‹¤', 'ä»·æ ¼': '13.9', 'æ•°é‡': 1 },
                { 'é¡¹ç›®': 'æˆ’æŒ‡SEO', 'é¡¹ç›®ID': 'ring', 'è´¦å·': 'åº—é“º', 'äº§å“': 'æ°´æ³¢çº¹æˆ’æŒ‡', 'å…³é”®è¯': 'æˆ’æŒ‡æ¨èå°ä¼—é«˜çº§', 'åœºæ™¯': 'è´¨æ„Ÿ', 'ä»·æ ¼': '13.9', 'æ•°é‡': 1 },
                { 'é¡¹ç›®': 'æˆ’æŒ‡SEO', 'é¡¹ç›®ID': 'ring', 'è´¦å·': 'åº—é“º', 'äº§å“': 'æ°´æ³¢çº¹æˆ’æŒ‡', 'å…³é”®è¯': 'æˆ’æŒ‡æ¨èå°ä¼—é«˜çº§', 'åœºæ™¯': 'å æˆ´', 'ä»·æ ¼': '13.9', 'æ•°é‡': 1 }
            ];
            
            const ws = XLSX.utils.json_to_sheet(template);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "æˆ’æŒ‡æ¨¡æ¿");
            XLSX.writeFile(wb, "æˆ’æŒ‡SEOè¾“å…¥æ¨¡æ¿.xlsx");
        
        
        // ========== æ¿€æ´»ç ç”Ÿæˆä¸éªŒè¯ ==========
        function generateActivationCode(businessType, expireDate) {
            const businessMap = {
                'social': 'SOCIAL',
                'ring': 'RING',
                'travel': 'TRAVEL',
                'psychology': 'PSY',
                'all': 'ALL'
            };
            
            const businessCode = businessMap[businessType];
            const dateStr = expireDate.replace(/-/g, '');
            
            const timestamp = Date.now().toString();
            const random = Math.random().toString(36).substring(2, 6).toUpperCase();
            const checkString = `${businessCode}${dateStr}${timestamp}${random}${CONFIG.SECRET_KEY}`;
            const checkHash = CryptoJS.MD5(checkString).toString().toUpperCase();
            const checkCode = checkHash.substring(0, 4);
            
            return `XHS-${businessCode}-${dateStr}-${checkCode}`;
        }
        
        function validateActivationCode(code) {
            const parts = code.trim().toUpperCase().split('-');
            
            const businessMap = {
                'SOCIAL': 'ç¤¾ä¼šåŒ–æŒ‡å—',
                'RING': 'æˆ’æŒ‡',
                'TRAVEL': 'æ—…æ¸¸',
                'PSY': 'å¿ƒç†æµ‹è¯•',
                'ALL': 'å…¨åŠŸèƒ½ç‰ˆ'
            };
            
            // æ”¯æŒä¸¤ç§æ ¼å¼ï¼š
            // æ—§æ ¼å¼ï¼šXHS-BUSINESS-DATE-CHECK (4æ®µ)
            // æ–°æ ¼å¼ï¼šXHS-BUSINESS-DATE-USERID-CHECK (5æ®µ)
            
            if (parts.length === 4 && parts[0] === 'XHS') {
                // æ—§æ ¼å¼å…¼å®¹ï¼ˆæ— è®¾å¤‡ç»‘å®šï¼‰
                const [prefix, businessCode, dateStr, checkCode] = parts;
                
                const checkString = `${businessCode}${dateStr}${CONFIG.SECRET_KEY}`;
                const expectedCheck = CryptoJS.MD5(checkString).toString().toUpperCase().substring(0, 4);
                
                if (checkCode !== expectedCheck) {
                    return { valid: false, message: 'æ¿€æ´»ç æ— æ•ˆ' };
                }
                
                const year = parseInt(dateStr.substring(0, 4));
                const month = parseInt(dateStr.substring(4, 6));
                const day = parseInt(dateStr.substring(6, 8));
                const expireDate = new Date(year, month - 1, day);
                
                if (new Date() > expireDate) {
                    return { valid: false, message: `æ¿€æ´»ç å·²è¿‡æœŸï¼ˆ${year}-${month}-${day}ï¼‰` };
                }
                
                const businessName = businessMap[businessCode] || businessCode;
                const expireDateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                return {
                    valid: true,
                    business: businessName,
                    expireDate: expireDateStr,
                    userId: 'legacy',
                    message: 'æ¿€æ´»ç æœ‰æ•ˆ'
                };
                
            } else if (parts.length === 5 && parts[0] === 'XHS') {
                // æ–°æ ¼å¼ï¼šæ”¯æŒç”¨æˆ·IDå’Œè®¾å¤‡ç»‘å®š
                const [prefix, businessCode, dateStr, userId, checkCode] = parts;
                
                // éªŒè¯æ ¡éªŒç ï¼ˆuserIdç”¨å°å†™è®¡ç®—ï¼‰
                const checkString = `${businessCode}${dateStr}${userId.toLowerCase()}${CONFIG.SECRET_KEY}`;
                const expectedCheck = CryptoJS.MD5(checkString).toString().toUpperCase().substring(0, 4);
                
                if (checkCode !== expectedCheck) {
                    return { valid: false, message: 'æ¿€æ´»ç æ— æ•ˆ' };
                }
                
                // éªŒè¯æ—¥æœŸ
                const year = parseInt(dateStr.substring(0, 4));
                const month = parseInt(dateStr.substring(4, 6));
                const day = parseInt(dateStr.substring(6, 8));
                const expireDate = new Date(year, month - 1, day);
                
                if (new Date() > expireDate) {
                    return { valid: false, message: `æ¿€æ´»ç å·²è¿‡æœŸï¼ˆ${year}-${month}-${day}ï¼‰` };
                }
                
                // è®¾å¤‡ç»‘å®šæ£€æŸ¥
                const boundUserId = localStorage.getItem('boundUserId');
                const deviceFingerprint = getDeviceFingerprint();
                const boundDevice = localStorage.getItem('boundDevice');
                
                // æ£€æŸ¥æ˜¯å¦å·²ç»‘å®šå…¶ä»–ç”¨æˆ·
                if (boundUserId && boundUserId !== userId.toLowerCase()) {
                    return { 
                        valid: false, 
                        message: `æ­¤è®¾å¤‡å·²ç»‘å®šè´¦å·: ${boundUserId}ã€‚å¦‚éœ€æ›´æ¢è¯·æ¸…é™¤æµè§ˆå™¨æ•°æ®åé‡è¯•` 
                    };
                }
                
                // æ£€æŸ¥æ¿€æ´»ç æ˜¯å¦å·²åœ¨å…¶ä»–è®¾å¤‡ä½¿ç”¨
                if (boundDevice && boundDevice !== deviceFingerprint) {
                    return { 
                        valid: false, 
                        message: 'æ­¤æ¿€æ´»ç å·²åœ¨å…¶ä»–è®¾å¤‡æ¿€æ´»ã€‚ä¸€ä¸ªæ¿€æ´»ç åªèƒ½ç»‘å®šä¸€ä¸ªè®¾å¤‡' 
                    };
                }
                
                // ä¿å­˜ç»‘å®šä¿¡æ¯
                localStorage.setItem('boundUserId', userId.toLowerCase());
                localStorage.setItem('boundDevice', deviceFingerprint);
                
                const businessName = businessMap[businessCode] || businessCode;
                const expireDateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                return {
                    valid: true,
                    business: businessName,
                    expireDate: expireDateStr,
                    userId: userId.toLowerCase(),
                    message: `æ¿€æ´»æˆåŠŸï¼å·²ç»‘å®šè´¦å·: ${userId.toLowerCase()}`
                };
                
            } else {
                return { valid: false, message: 'æ¿€æ´»ç æ ¼å¼é”™è¯¯ï¼ˆåº”ä¸ºXHS-XXX-XXX-XXXæˆ–XHS-XXX-XXX-XXX-XXXï¼‰' };
            }
        }
        
        // ========== ç®¡ç†å‘˜åŠŸèƒ½ ==========
        function showAdminModal() {
            document.getElementById('adminModal').classList.add('show');
        }
        
        function closeAdminModal() {
            document.getElementById('adminModal').classList.remove('show');
        }
        
        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            const status = document.getElementById('adminLoginStatus');
            
            if (password === CONFIG.ADMIN_PASSWORD) {
                showStatus(status, 'âœ… ç™»å½•æˆåŠŸ', 'success');
                setTimeout(() => {
                    document.getElementById('adminLogin').classList.add('hidden');
                    document.getElementById('adminPanel').classList.remove('hidden');
                    loadCodeHistory();
                }, 500);
            } else {
                showStatus(status, 'âŒ å¯†ç é”™è¯¯', 'error');
            }
        }
        
        function adminLogout() {
            document.getElementById('adminLogin').classList.remove('hidden');
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('adminPassword').value = '';
            document.getElementById('adminLoginStatus').classList.add('hidden');
        }
        
        function setQuickDate(days) {
            const date = new Date();
            date.setDate(date.getDate() + days);
            document.getElementById('expireDate').value = date.toISOString().split('T')[0];
        }
        
        function generateCode() {
            const businessType = document.getElementById('businessType').value;
            const expireDate = document.getElementById('expireDate').value;
            
            if (!expireDate) {
                alert('è¯·é€‰æ‹©åˆ°æœŸæ—¥æœŸ');
                return;
            }
            
            const code = generateActivationCode(businessType, expireDate);
            
            document.getElementById('generatedCode').textContent = code;
            document.getElementById('codeDisplay').classList.remove('hidden');
            
            saveCodeToHistory(code, businessType, expireDate);
            loadCodeHistory();
        }
        
        function copyCode() {
            const code = document.getElementById('generatedCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                alert('æ¿€æ´»ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            });
        }
        
        function saveCodeToHistory(code, businessType, expireDate) {
            let history = JSON.parse(localStorage.getItem('codeHistory') || '[]');
            history.unshift({
                code,
                businessType,
                expireDate,
                generatedAt: new Date().toISOString()
            });
            localStorage.setItem('codeHistory', JSON.stringify(history.slice(0, 50)));
        }
        
        function loadCodeHistory() {
            const history = JSON.parse(localStorage.getItem('codeHistory') || '[]');
            const container = document.getElementById('codeList');
            
            if (history.length === 0) {
                container.innerHTML = '<p style="color: #999; text-align: center;">æš‚æ— æ¿€æ´»ç è®°å½•</p>';
                return;
            }
            
            const businessMap = {
                'social': 'ç¤¾ä¼šåŒ–æŒ‡å—',
                'ring': 'æˆ’æŒ‡',
                'travel': 'æ—…æ¸¸',
                'psychology': 'å¿ƒç†æµ‹è¯•',
                'all': 'å…¨éƒ¨ä¸šåŠ¡çº¿'
            };
            
            container.innerHTML = history.map(item => `
                <div class="code-item">
                    <div style="font-weight: bold; font-family: 'Courier New'; color: #667eea; margin-bottom: 5px;">
                        ${item.code}
                    </div>
                    <div style="font-size: 12px; color: #666;">
                        ä¸šåŠ¡: ${businessMap[item.businessType]} | 
                        åˆ°æœŸ: ${item.expireDate} | 
                        ç”Ÿæˆ: ${new Date(item.generatedAt).toLocaleString()}
                    </div>
                </div>
            `).join('');
        }
        
        // ========== ç”¨æˆ·ç«¯ï¼šæ¿€æ´»åŠŸèƒ½ ==========
        function activate() {
            const code = document.getElementById('activationCode').value.trim();
            const status = document.getElementById('activationStatus');
            
            if (!code) {
                showStatus(status, 'è¯·è¾“å…¥æ¿€æ´»ç ', 'error');
                return;
            }
            
            const result = validateActivationCode(code);
            
            if (result.valid) {
                localStorage.setItem('activation', JSON.stringify({
                    code,
                    business: result.business,
                    expireDate: result.expireDate,
                    userId: result.userId || 'legacy'
                }));
                
                showStatus(status, `âœ… ${result.message}`, 'success');
                
                setTimeout(() => {
                    document.getElementById('activationSection').classList.add('hidden');
                    document.getElementById('activatedInfo').classList.remove('hidden');
                    document.getElementById('apiSection').classList.remove('hidden');
                    
                    document.getElementById('businessInfo').textContent = result.business;
                    document.getElementById('expireInfo').textContent = result.expireDate;
                    
                    // æ˜¾ç¤ºç”¨æˆ·IDï¼ˆå¦‚æœæœ‰ï¼‰
                    if (result.userId && result.userId !== 'legacy') {
                        document.getElementById('businessInfo').textContent += ` (${result.userId})`;
                    }
                }, 1000);
            } else {
                showStatus(status, `âŒ ${result.message}`, 'error');
            }
        }
        
        function resetActivation() {
            if (confirm('ç¡®å®šè¦é‡æ–°æ¿€æ´»å—ï¼Ÿå½“å‰é…ç½®å°†è¢«æ¸…é™¤ã€‚')) {
                localStorage.removeItem('activation');
                localStorage.removeItem('apiKey');
                location.reload();
            }
        }
        
        // ========== ç”¨æˆ·ç«¯ï¼šAPIé…ç½® ==========
        function saveApiKey() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const status = document.getElementById('apiStatus');
            
            if (!apiKey) {
                showStatus(status, 'è¯·è¾“å…¥API Key', 'error');
                return;
            }
            
            localStorage.setItem('apiKey', apiKey);
            showStatus(status, 'âœ… API Keyå·²ä¿å­˜', 'success');
            
            setTimeout(() => {
                document.getElementById('generateSection').classList.remove('hidden');
            }, 500);
        }
        
        // ========== ç”¨æˆ·ç«¯ï¼šæ–‡ä»¶å¤„ç† ==========
        let excelData = null;
        
        function handleFileSelect() {
            const file = document.getElementById('excelFile').files[0];
            const status = document.getElementById('fileInfo');
            
            if (!file) {
                status.classList.add('hidden');
                document.getElementById('generateBtn').disabled = true;
                return;
            }
            
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    const sheet = workbook.Sheets[sheetName];
                    excelData = XLSX.utils.sheet_to_json(sheet);
                    
                    if (!excelData[0] || !excelData[0]['æ ‡é¢˜']) {
                        showStatus(status, 'âŒ Excelæ–‡ä»¶å¿…é¡»åŒ…å«"æ ‡é¢˜"åˆ—ï¼Œå»ºè®®ä¸‹è½½æ¨¡æ¿å¡«å†™', 'error');
                        document.getElementById('generateBtn').disabled = true;
                        return;
                    }
                    
                    showStatus(status, `âœ… æ–‡ä»¶: ${file.name} | æ•°æ®: ${excelData.length} æ¡`, 'success');
                    document.getElementById('generateBtn').disabled = false;
                } catch (error) {
                    showStatus(status, 'âŒ æ–‡ä»¶è¯»å–å¤±è´¥ï¼š' + error.message, 'error');
                    document.getElementById('generateBtn').disabled = true;
                }
            };
            reader.readAsArrayBuffer(file);
        }
        
        // ========== ç”¨æˆ·ç«¯ï¼šç”ŸæˆåŠŸèƒ½ ==========
        let isGenerating = false;
        
        
        // ========== æš‚åœåŠŸèƒ½ ==========
        function pauseGeneration() {
            pauseRequested = true;
            isPaused = true;
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('resumeBtn').style.display = 'inline-block';
            addLog('â¸ï¸ å·²æš‚åœï¼Œæ­£åœ¨ä¿å­˜å·²ç”Ÿæˆçš„å†…å®¹...');
        }
        
        function resumeGeneration() {
            pauseRequested = false;
            isPaused = false;
            document.getElementById('resumeBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'inline-block';
            addLog('â–¶ï¸ ç»§ç»­ç”Ÿæˆ...');
        }
        
        async function startGeneration() {
            if (isGenerating || !excelData) return;
            
            isGenerating = true;
            document.getElementById('generateBtn').disabled = true;
            document.getElementById('pauseBtn').style.display = 'inline-block';
            document.getElementById('resumeBtn').style.display = 'none';
            pauseRequested = false;
            isPaused = false;
            document.getElementById('progressContainer').classList.remove('hidden');
            
            const log = document.getElementById('log');
            log.innerHTML = '';
            
            const apiKey = localStorage.getItem('apiKey');
            // è¿‡æ»¤ç©ºæ ‡é¢˜
            const validData = excelData.filter(row => {
                const title = (row['æ ‡é¢˜'] || '').toString().trim();
                return title.length > 0 && title !== 'NaN' && title !== 'nan';
            });
            
            if (validData.length === 0) {
                addLog('âŒ æ²¡æœ‰æœ‰æ•ˆçš„æ ‡é¢˜æ•°æ®ï¼');
                return;
            }
            
            addLog(`ğŸ“Š å…±${validData.length}ä¸ªæœ‰æ•ˆæ ‡é¢˜`);
            
            // è®¡ç®—æ€»ä»»åŠ¡æ•°ï¼ˆè€ƒè™‘ç”Ÿæˆæ•°é‡ï¼‰
            let totalTasks = 0;
            validData.forEach(row => {
                const count = parseInt(row['ç”Ÿæˆæ•°é‡']) || 1;
                totalTasks += count;
            });
            
            const results = [];
            let taskIndex = 0;
            
            for (let i = 0; i < validData.length; i++) {
                const row = validData[i];
                const title = row['æ ‡é¢˜'] || '';
                const topic = row['é€‰é¢˜'] || 'é€šç”¨';
                const generateCount = parseInt(row['ç”Ÿæˆæ•°é‡']) || 1;
                
                // æ ¹æ®ç”Ÿæˆæ•°é‡å¾ªç¯
                for (let j = 0; j < generateCount; j++) {
                    taskIndex++;
                    
                    // æ£€æŸ¥æ˜¯å¦è¯·æ±‚æš‚åœ
                    if (pauseRequested) {
                        addLog('â¸ï¸ æš‚åœç”Ÿæˆï¼Œæ­£åœ¨ä¸‹è½½å·²ç”Ÿæˆçš„å†…å®¹...');
                        break;
                    }
                    
                    addLog(`[${taskIndex}/${totalTasks}] ${title.substring(0, 40)}... (ç¬¬${j+1}/${generateCount}æ¡)`);
                    
                    try {
                        let rawContent = await generateSingle(apiKey, title, topic);
                    
                    // è¿‡æ»¤æ•æ„Ÿè¯
                    rawContent = filterSensitiveWords(rawContent);
                    
                    // è¿‡æ»¤é€‰é¢˜ä¸­çš„æ•æ„Ÿè¯
                    const cleanTopic = filterSensitiveWords(topic);
                    
                    // æå–è¯é¢˜æ ‡ç­¾
                    const extracted = extractTags(rawContent);
                    
                    results.push({
                        'åºå·': taskIndex,
                        'æ ‡é¢˜': title,
                        'é€‰é¢˜': cleanTopic,
                        'æ–‡æ¡ˆ': extracted.content,
                        'è¯é¢˜': extracted.tags,
                        'å­—æ•°': extracted.content.length
                    });
                    addLog(`âœ“ æˆåŠŸ (${extracted.content.length}å­—)`);
                } catch (error) {
                    const cleanTopic = filterSensitiveWords(topic);
                    results.push({
                        'åºå·': taskIndex,
                        'æ ‡é¢˜': title,
                        'é€‰é¢˜': cleanTopic,
                        'æ–‡æ¡ˆ': `ç”Ÿæˆå¤±è´¥: ${error.message}`,
                        'è¯é¢˜': '',
                        'å­—æ•°': 0
                    });
                    addLog(`âœ— å¤±è´¥: ${error.message}`);
                }
                
                updateProgress(Math.round(taskIndex / totalTasks * 100));
                }
                
                // å¤–å±‚å¾ªç¯æ£€æŸ¥æš‚åœ
                if (pauseRequested) {
                    break;
                }
            }
            
            // ä¸‹è½½ç»“æœ
            downloadExcel(results);
            
            isGenerating = false;
            document.getElementById('generateBtn').disabled = false;
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('resumeBtn').style.display = 'none';
            
            if (pauseRequested) {
                addLog(`\nâ¸ï¸ æš‚åœå®Œæˆï¼å·²ç”Ÿæˆ ${results.length} æ¡æ–‡æ¡ˆ`);
            } else {
                addLog('\nâœ… å…¨éƒ¨å®Œæˆï¼æ–‡ä»¶å·²ä¸‹è½½ã€‚');
            }
        }
        
        async function generateSingle(apiKey, keyword, scene, product, price) {
            const prompt = `ä½ æ˜¯å°çº¢ä¹¦æˆ’æŒ‡ç±»ç›®çš„çˆ†æ¬¾æ–‡æ¡ˆåˆ›ä½œè€…ã€‚

ã€ä»»åŠ¡ã€‘
ä¸º"${product}"åˆ›ä½œä¸€ç¯‡å°çº¢ä¹¦ç§è‰æ–‡æ¡ˆï¼Œèšç„¦"${scene}"åœºæ™¯ã€‚

ã€äº§å“ä¿¡æ¯ã€‘
- äº§å“åç§°ï¼š${product}
- ä»·æ ¼ï¼š${price}å…ƒ  
- æ ¸å¿ƒå…³é”®è¯ï¼š${keyword}

ã€åœºæ™¯éœ€æ±‚ã€‘
é’ˆå¯¹"${scene}"åœºæ™¯çš„ç”¨æˆ·éœ€æ±‚ï¼š
- åŒäº‹/èšä¼šï¼šéœ€è¦èŒåœºæ°”è´¨ã€ä¸å¤±ç¤¼ã€æ˜¾å“å‘³
- æ‰‹å‹ç—›ç‚¹ï¼šéœ€è¦ä¿®é¥°æ‰‹å‹ã€æ˜¾æ‰‹ç™½ã€æ˜¾æ‰‹é•¿
- ä»·æ ¼å¯¹æ¯”ï¼šéœ€è¦æ€§ä»·æ¯”ã€å“è´¨å¥½ã€ä»·æ ¼å®æƒ 
- ç”·å‹/å¦ˆå¦ˆï¼šéœ€è¦é€ç¤¼ã€è¡¨è¾¾å¿ƒæ„ã€æœ‰å¯“æ„
- æ‹ç…§ï¼šéœ€è¦ä¸Šé•œã€å‡ºç‰‡ã€insé£
- é€šå‹¤ï¼šéœ€è¦ç™¾æ­ã€ç®€çº¦ã€æ—¥å¸¸
- è´¨æ„Ÿ/å æˆ´ï¼šéœ€è¦è®¾è®¡æ„Ÿã€æ­é…æ€§ã€æ—¶å°š

ã€æ ‡é¢˜è¦æ±‚ã€‘
1. å¿…é¡»åŒ…å«å…³é”®è¯"${keyword}"
2. å¸å¼•${scene}åœºæ™¯çš„ç›®æ ‡äººç¾¤
3. 15-25å­—ï¼ŒåŠ ï½œåˆ†éš”ï¼Œæœ‰é’©å­
4. ç¤ºä¾‹ï¼š
   - "æˆ’æŒ‡æ¨èï½œåŒäº‹èšä¼šæˆ´è¿™æ¬¾ï¼Œæ°”è´¨æ‹‰æ»¡ä¸æ’æ¬¾"
   - "å°ä¼—æˆ’æŒ‡ï½œæ‰‹ç²—æ‰‹çŸ­æ•‘æ˜Ÿï¼æ˜¾æ‰‹ç™½è¿˜æ˜¾æ‰‹é•¿"
   - "æ°´æ³¢çº¹æˆ’æŒ‡ï½œ14å…ƒçš„å“è´¨å ªæ¯”å¤§ç‰Œï¼Œå§å¦¹å¿«å†²"

ã€æ­£æ–‡è¦æ±‚ã€‘
400-500å­—ï¼Œåˆ†4æ®µï¼š

ç¬¬1æ®µï¼ˆåœºæ™¯ç—›ç‚¹ï¼‰ï¼š
ä»"${scene}"åœºæ™¯åˆ‡å…¥ï¼Œè¯´å‡ºç”¨æˆ·ç—›ç‚¹æˆ–éœ€æ±‚ã€‚
ç¤ºä¾‹ï¼š"å§å¦¹ä»¬ï¼Œæ˜¯ä¸æ˜¯æ¯æ¬¡åŒäº‹èšä¼šéƒ½ä¸çŸ¥é“æˆ´ä»€ä¹ˆæˆ’æŒ‡ï¼Ÿæˆ´å¤ªå¤¸å¼ æ€•ä¸åˆé€‚ï¼Œæˆ´å¤ªç®€å•åˆæ²¡æ°”è´¨..."

ç¬¬2æ®µï¼ˆäº§å“äº®ç‚¹ï¼‰ï¼š
ä»‹ç»æ°´æ³¢çº¹è®¾è®¡ã€æè´¨ã€å·¥è‰ºã€‚
- æµåŠ¨çš„æ°´æ³¢çº¹çº¿æ¡
- S925é“¶æè´¨
- ç”µé•€å·¥è‰ºä¸æ˜“æ°§åŒ–
- è½»ç›ˆä¸å‹æ‰‹

ç¬¬3æ®µï¼ˆä½©æˆ´æ•ˆæœï¼‰ï¼š
ç»“åˆåœºæ™¯è¯´æ•ˆæœã€‚
- æ˜¾æ‰‹ç™½/æ˜¾æ‰‹é•¿
- ç™¾æ­å„ç§é£æ ¼
- èŒåœº/æ—¥å¸¸éƒ½åˆé€‚
- æ‹ç…§è¶…å‡ºç‰‡

ç¬¬4æ®µï¼ˆè´­ä¹°å¼•å¯¼ï¼‰ï¼š
è‡ªç„¶å¼•å¯¼ï¼Œä¸è¦ç¡¬å¹¿ã€‚
ç¤ºä¾‹ï¼š"è¿™æ¬¾åœ¨æˆ‘çš„å°çº¢ä¹¦åº—é“ºæœ‰ï¼Œ${price}å…ƒå°±èƒ½å…¥æ‰‹ï¼ŒçœŸçš„å¤ªåˆ’ç®—äº†ï¼ç‚¹å‡»æˆ‘çš„ä¸»é¡µå°±èƒ½çœ‹åˆ°å•¦~"

ã€è¯­æ°”é£æ ¼ã€‘
- åƒé—ºèœœèŠå¤©ï¼Œäº²åˆ‡è‡ªç„¶
- å¤šç”¨emojiï¼ˆğŸ’âœ¨ğŸ’•ğŸ‘€ç­‰ï¼‰
- å£è¯­åŒ–è¡¨è¾¾
- çœŸè¯šä¸åšä½œ

ã€ç¦ç”¨è¯ã€‘
é¿å…ï¼šè´­ä¹°ã€ä¸‹å•ã€ä¹°ä¹°ä¹°ã€é™æ—¶ã€ç§’æ€ç­‰è¥é”€è¯
ç”¨ï¼šçœ‹çœ‹ã€äº†è§£ã€å…¥æ‰‹ã€getç­‰è½¯æ€§è¯

ã€è¯é¢˜æ ‡ç­¾ã€‘
æ–‡æ¡ˆæœ€ååŠ 5-8ä¸ªç›¸å…³è¯é¢˜ï¼š
#${keyword} #æˆ’æŒ‡æ¨è #æ°´æ³¢çº¹æˆ’æŒ‡ #å°ä¼—æˆ’æŒ‡ #æ—¥å¸¸æˆ’æŒ‡ #${scene}ç©¿æ­

ã€è¾“å‡ºã€‘
åªè¾“å‡ºå®Œæ•´æ–‡æ¡ˆï¼ŒåŒ…å«æ ‡é¢˜+æ­£æ–‡+è¯é¢˜æ ‡ç­¾ï¼Œä¸è¦ä»»ä½•è§£é‡Šã€‚`;
            
            const response = await fetch(CONFIG.API_BASE_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: CONFIG.MODEL,
                    max_tokens: 1200,
                    temperature: 0.9,
                    messages: [{
                        role: 'user',
                        content: prompt
                    }]
                })
            });
            
            if (!response.ok) {
                throw new Error(`APIé”™è¯¯: ${response.statusText}`);
            }
            
            const data = await response.json();
            
            // æå–æ–‡æ¡ˆå†…å®¹ï¼ˆå¢åŠ å®¹é”™ï¼‰
            let content = '';
            if (data.content && Array.isArray(data.content) && data.content.length > 0) {
                content = data.content[0].text || '';
            } else if (data.text) {
                content = data.text;
            } else if (typeof data === 'string') {
                content = data;
            }
            
            if (!content || content.trim() === '') {
                throw new Error('APIè¿”å›å†…å®¹ä¸ºç©º');
            }
            
            return content.trim();
        }
        
        function downloadExcel(data) {
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "ç”Ÿæˆç»“æœ");
            
            const timestamp = new Date().toISOString().replace(/[:-]/g, '').split('.')[0];
            XLSX.writeFile(wb, `å°çº¢ä¹¦æ–‡æ¡ˆ_${timestamp}.xlsx`);
        }
        
        // ========== UIè¾…åŠ©å‡½æ•° ==========
        function showStatus(element, message, type) {
            element.textContent = message;
            element.className = `status ${type}`;
            element.style.display = 'block';
        }
        
        function updateProgress(percent) {
            const fill = document.getElementById('progressFill');
            fill.style.width = percent + '%';
            fill.textContent = Math.round(percent) + '%';
        }
        
        function addLog(message) {
            const log = document.getElementById('log');
            const item = document.createElement('div');
            item.className = 'log-item';
            item.textContent = message;
            log.appendChild(item);
            log.scrollTop = log.scrollHeight;
        }
        
        // ========== é¡µé¢åŠ è½½åˆå§‹åŒ– ==========
        window.onload = function() {
            const activation = localStorage.getItem('activation');
            const apiKey = localStorage.getItem('apiKey');
            
            if (activation) {
                const info = JSON.parse(activation);
                document.getElementById('activationSection').classList.add('hidden');
                document.getElementById('activatedInfo').classList.remove('hidden');
                document.getElementById('apiSection').classList.remove('hidden');
                document.getElementById('businessInfo').textContent = info.business;
                document.getElementById('expireInfo').textContent = info.expireDate;
                
                if (apiKey) {
                    document.getElementById('apiKey').value = apiKey;
                    document.getElementById('generateSection').classList.remove('hidden');
                }
            }
            
            setQuickDate(365);
        };
    </script>
</body>
</html>
